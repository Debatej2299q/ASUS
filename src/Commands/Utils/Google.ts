/** @format */

import { BaseCommand, Command, Message } from '../../Structures'
import { IArgs } from '../../Types'
import axios from "axios";

@Command( "google", {
    aliases: ["g", "search"],
    description: "Search on the web ",
    category: "utils",
    usage: `google [query]`,
    cooldown: 5,
    exp: 10,
    dm: false
})
export default class extends BaseCommand {
    public override execute = async (M: Message, args: IArgs): Promise<void> => {
    if (!this.client.config.gkey) return void M.reply("No google API key set");
    if (!joined) return void M.reply("üîé Provide a search term");
    const term = joined.trim();
    await axios
      .get(
        `https://www.googleapis.com/customsearch/v1?q=${term}&key=${this.client.config.gkey}&cx=baf9bdb0c631236e5`
      )
      .then((res) => {
        if (res.status !== 200) return void M.reply(`üîç Error: ${res.status}`);
        let result = ``;
        let index = 1;
        for (const item of res.data?.items) {
          result += `*üëæ${index}.Title* : ${item.title}\n*üîóLink* : ${item.link}\n*üìñSnippet* : ${item.snippet}\n\n`;
          index++;
        }
        // return void M.reply(`üîçCommand Used : ${Command.count} times\n Result for *${term}*\n\n\n ${result}`)
        return void M.reply(`üîç Result for *${term}*\n\n\n ${result}`);
      })
      .catch((err) => {
        M.reply(`üîç Error: ${err}`);
      });
  };
}
